@page "/"

@using Product_Catalog.Client.Layout
@layout AuthenticationLayout 

<MudContainer Class="d-flex justify-center align-center min-height-100vh main-content">
    <MudCard Class="mud-elevation-12 card-login" Style="background-color: rgba(1, 1, 1, 0.8);">
        <MudCardHeader Class="d-flex justify-center">
            <MudText Typo="Typo.h5">Login</MudText>
        </MudCardHeader>

        <MudCardContent>
            <EditForm Enhance Model="UserLogin" OnValidSubmit="HandleLogin">
                <DataAnnotationsValidator />
                <MudTextField @bind-Value="UserLogin.Email" Label="Email" Required="true" />
                <MudTextField InputType="InputType.Password" @bind-Value="UserLogin.Senha" Label="Senha" Required="true" />

                <MudButton Type="Submit" Variant="Variant.Filled" Color="Color.Primary" Class="mt-4" FullWidth="true">Login</MudButton>
            </EditForm>
        </MudCardContent>

        <MudCardActions Class="justify-center">
            <MudText Typo="Typo.caption" Class="text-center">
                Ainda não tem uma conta?
                <MudLink Href="/cadastro" Class="ml-2">Cadastre-se</MudLink>
            </MudText>
        </MudCardActions>
    </MudCard>

</MudContainer>

<style>
    .main-content {
        display: flex;
        justify-content: center;
    }

    .mud-paper {
        margin-top: 15em;
        min-width: 350px;
        border-radius: 10px;
    }

    .mud-card-content {
        padding: 25px !important;
    }
</style>

@code {
    public DTOs.LoginRequestDTO UserLogin = new DTOs.LoginRequestDTO();

    private async Task HandleLogin()
    {
        // var result = await accountService.Login(UserLogin);

        // if (result.Flag)
        // {
        //     var customAuthStateProvider = (CustomAuthenticationStateProvider)AuthStateProvider;
        //     await customAuthStateProvider.UpdateAuthenticationState(new UserSession()
        //     {
        //         Token = result.Token, RefreshToken = result.RefreshToken
        //     });
        //     NavManager.NavigateTo("/", forceLoad: true);
        // }
    }
}
